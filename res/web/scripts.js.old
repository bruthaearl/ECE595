
var current_time = new Date();
var json_obj = JSON.parse(document.getElementById('testdat').innerHTML);
const db_setpoint = 'testdata.json';


function updateElement(element, newstuff){
	document.getElementById(element).innerHTML = newstuff;
	return 0;
}

console.log(json_obj);

updateElement("time", current_time.getHours()+":"+current_time.getMinutes());
updateElement("temp", json_obj.stats[0].current_temp + "&degC");
updateElement("setpoint", json_obj.stats[0].current_setpoint + "&degC");

if(json_obj.stats[0].heater_status){ 
	updateElement("stat", "ON");
	document.getElementById("stat").style.color = "#D35400";
}
else{
	updateElement("stat", "OFF");
	document.getElementById("stat").style.color = "#3498DB";
}

const setpoints_table = document.getElementById('setpoints_table'); 

function createNode(element){
	return document.createElement(element);	
}

function append(parent, element){
	return parent.appendChild(element);
}

function updateSetpoints(setpoint_array){

	return setpoint_array.map(function(setpoint){
		console.log(setpoint.temp);
		let row = createNode('tr');
		let id_td = createNode('td');
		let setpoint_td = createNode('td');
		let time_td = createNode('td');
		
		id_td.innerHTML = setpoint.id;
		setpoint_td.innerHTML = setpoint.temp;
		time_td.innerHTML = setpoint.time_h + ":" + setpoint.time_m;
		
		append(row, id_td);
		append(row, setpoint_td);
		append(row, time_td);
		append(setpoints_table, row);
	})	

}


updateSetpoints(json_obj.setpoints);